<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>WorldEditArt</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="WorldEditArt.tex"> 
<link rel="stylesheet" type="text/css" href="WorldEditArt.css"> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">WorldEditArt</h2>
<div class="author" ><span 
class="cmss-12">SOFe</span></div><br />
<div class="date" ><span 
class="cmss-12">2017-07-20</span></div>
   </div>
<!--l. 17--><p class="indent" >   This proposal describes a world edit plugin largely based on features originally
intended in WorldEditArt, along with some new ideas.
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Plugin mechanism</h3>
<!--l. 21--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-20001.1"></a>Builder sessions</h4>
<!--l. 22--><p class="noindent" >Users of this plugin should be managed in &#8221;builder sessions&#8221; with individual access
information. Builder sessions can be created in three modes, namely:
<!--l. 24--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-30001.1"></a><span 
class="cmssbx-10">Implicit Mode</span></span>
   Players with a certain permission will start a builder session upon joining
a game. The session&#8217;s permission and location will be synchronized with the
player.
<!--l. 27--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-40001.1"></a><span 
class="cmssbx-10">Explicit Mode</span></span>
   Players with a certain permission will start a builder session upon typing a command.
The session&#8217;s permission and location will be synchronized with the player, and can be
closed with a command. The command may be locked with a private password (similar to
the <span 
class="cmtt-10">sudo </span>Linux command) or global password (similar to the <span 
class="cmtt-10">su </span>Linux command) for
additional protection.
<!--l. 32--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-50001.1"></a><span 
class="cmssbx-10">Minion Mode</span></span>
   Command senders with a certain permission (especially non-in-game senders like
console) can create minion builder sessions upon typing a command. The session&#8217;s
permission and location will be controlled by the command sender. Each builder session
                                                                  

                                                                  
has an allocated amount of resources; this allocation may affect the rate of world-editing
operations to maximize server performance.
<!--l. 39--><p class="indent" >   For implicit and explicit modes, the builder session&#8217;s position and orientation is
synchronized with the player. The position uses the block that <span 
class="cmssbx-10">the player&#8217;s feet stand</span>
<span 
class="cmssbx-10">in</span>.
     <ul class="itemize1">
     <li class="itemize">If the player is floating on a lake of liquid, the highest level of the liquid is
     used.
     </li>
     <li class="itemize">If the player is standing on a full block (or the part of the block with full
     height, e.g. an upper slab, the upper step of a stair block), the <span 
class="cmssi-10">air block above</span>
     the full block is used.
     </li>
     <li class="itemize">If the player is standing on an incomplete block (e.g. a lower slab, a chest
     block, an open-upwards trapdoor), the block itself is used.</li></ul>
<!--l. 47--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-60001.2"></a>The core world editing chain</h4>
     <ul class="itemize1">
     <li class="itemize">Selection
     </li>
     <li class="itemize">Block Iterator
     </li>
     <li class="itemize">Block Changer
     </li>
     <li class="itemize">Cassette
     </li>
     <li class="itemize">User History
     </li>
     <li class="itemize">Load Synchronizer</li></ul>
                                                                  

                                                                  
<!--l. 57--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.1   </span> <a 
 id="x1-70001.2.1"></a>Selection and block iterator</h5>
<!--l. 58--><p class="noindent" >A selection refers to a 3D shape. A selection can be created by various methods as
described in the <span 
class="cmssbx-10">??</span> section.
<!--l. 61--><p class="indent" >   By default, all commands only affect the selection named &#8221;default&#8221;. Builder
sessions may also create other selections, identified by case-insensitive names. The
selections should be discarded upon closing a builder session (e.g. when a player
quits).
<!--l. 65--><p class="indent" >   A selection should provide an iterator providing a unique stream of blocks within the
selection, or blocks on the margin of the selection at a defined padding (inside the
border) and margin (outside the border).
<!--l. 69--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.2   </span> <a 
 id="x1-80001.2.2"></a>Block changer</h5>
<!--l. 70--><p class="noindent" >A block changer is an interface that accepts a Block argument and returns another Block
argument, determining the new block to set.
<!--l. 73--><p class="indent" >   Four implementations of block changer are proposed:
<!--l. 74--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-90001.2.2"></a><span 
class="cmssbx-10">Simple block changer</span></span>
   The blocks are always set to the specified block type.
<!--l. 75--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-100001.2.2"></a><span 
class="cmssbx-10">Repeating block changer</span></span>
   A list of block types is provided by the user, and the blocks are returned in a loop. For
example, if the user specifies <span 
class="cmtt-10">1 glowstone, 2 glass, 3 stone, 1 lantern</span>, the first
block set is a glowstone, the next two are glass, etc. This loop repeats at the 9<sup class="textsuperscript"><span 
class="cmss-9">th</span></sup> block.
This is useful for generating patterns in a rectangle or a cuboid, but the direction is
undefined.
<!--l. 79--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-110001.2.2"></a><span 
class="cmssbx-10">Random list block changer</span></span>
   A list of block types is provided by the user. Each block is set to one of the block
types in the list randomly selected.
<!--l. 81--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-120001.2.2"></a><span 
class="cmssbx-10">Weighted random list block changer</span></span>
   Same as random list block changer, except that the block types have different
probability of being selected.
<!--l. 84--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.3   </span> <a 
 id="x1-130001.2.3"></a>Clipboard chain</h5>
<!--l. 85--><p class="noindent" >An alternative chain is <span 
class="cmtt-10">Clipboard -&#x003E; Cassette -&#x003E; User History -&#x003E; Load</span>
<span 
class="cmtt-10">Synchronizer</span>, where the clipboard provides both the block iterator and the block
changer. More details will be described in the <span 
class="cmssbx-10">??</span> section.
                                                                  

                                                                  
<!--l. 89--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.4   </span> <a 
 id="x1-140001.2.4"></a>Cassette</h5>
<!--l. 90--><p class="noindent" >A cassette is a section of server memory, or a temporary file on the hard disk (if greater
than 10MB), storing an ordered list of blocks changed in an operation. It can be
re-executed in forward or backward order to redo/undo the operation.
<!--l. 94--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.5   </span> <a 
 id="x1-150001.2.5"></a>User history</h5>
<!--l. 95--><p class="noindent" >A user history manages an &#8221;undo stack&#8221; and a &#8221;redo stack&#8221;, each holding an ordered list
of cassettes. When the user requests to undo or redo, a cassette from one stack will
be moved to the other stack, and pass a reference to the cassette to the load
synchronizer.
<!--l. 99--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.6   </span> <a 
 id="x1-160001.2.6"></a>Load synchronizer</h5>
<!--l. 100--><p class="noindent" >The load synchronizer manages chunk locking and cassette operation queuing. Before
starting an operation, it determines whether the operation should be executed
synchronously or asynchronously and stores the chunks (identifiers only) affected by the
cassette to manage locking. <span 
class="cmssi-10">Cassette operations owned by the same builder session will</span>
<span 
class="cmssi-10">be executed one by one, but cassette operations owned by different builder sessions are</span>
<span 
class="cmssi-10">executed orderlessly.</span>
<!--l. 106--><p class="indent" >   If the selection shape supports reporting the maximum number of blocks changed per
chunk, it would determine whether to use the synchronous strategy (updating a
few blocks every tick) or the asynchronous strategy (lock the chunks, pass all
parameters to an AsyncTask, modify them on the other thread and send the whole
chunks).
<!--l. 111--><p class="noindent" >
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.7   </span> <a 
 id="x1-170001.2.7"></a>User interface</h5>
<!--l. 112--><p class="noindent" >While the chain consists of five components, the user only needs to make two inputs, and
only look at the final user history.
<!--l. 115--><p class="indent" >   A builder session first creates a selection using specific means (e.g. wands, commands,
etc.). After confirming the selection, the user can execute a manipulation command, e.g.
<span 
class="cmtt-10">//set</span>, <span 
class="cmtt-10">//replace</span>, etc. This will trigger the block iterator from the selection and
instantiate a block changer from the manipulation command&#8217;s arguments. A cassette will
be inserted into the user history, and the user history shall pull data from block iterator
and block changer into the cassette for execution.
<!--l. 122--><p class="indent" >   If the load synchronizer contains cassettes used by the user, it should show a progress
bar on the user&#8217;s screen (tips for players, periodic logger messages (at a lower frequency)
for console).
                                                                  

                                                                  
<!--l. 125--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">1.3   </span> <a 
 id="x1-180001.3"></a>Shape selection</h4>
<!--l. 126--><p class="noindent" >The geometric logic is implemented in <span 
class="cmssi-10">libgeom</span>, while the UI logic is implemented in this
plugin.
<!--l. 128--><p class="indent" >   A
<!--l. 128--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-190001.3"></a><span 
class="cmssbx-10">wand</span></span>
   refers to a combination of an item and an action; left-clicking with an emerald and
right-clicking with an emerald are considered as two different wands.
<!--l. 131--><p class="indent" >   A wand can be virtually used using a command. For example, the command <span 
class="cmtt-10">//pos1</span>
is equivalent to clicking the <span 
class="cmtt-10">pos1 </span>wand at the block that the builder session currently
stands in.
    
</body></html> 

                                                                  


